<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë°°ë“œë¯¼í„´ ë§¤ì¹˜ ê¸°ë¡ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #1a1a1a; color: white; font-family: 'Noto Sans KR', sans-serif; }
        .card { background-color: #2a2a2a; border-radius: 15px; padding: 20px; margin-bottom: 20px; border: 1px solid #333; }
        input { background: #333; border: 1px solid #444; color: white; padding: 10px; border-radius: 8px; width: 100%; margin-top: 5px; }
    </style>
</head>
<body class="p-4">
    <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-bold text-center mb-6 text-green-400">ğŸ¸ MATCH TRACKER</h1>

        <div class="card">
            <h2 class="text-lg font-bold mb-4 text-gray-300 border-b border-gray-600 pb-2">ìƒˆ ê²½ê¸° ê¸°ë¡</h2>
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-gray-400">ë‚´ ì´ë¦„</label>
                    <input type="text" id="p1" placeholder="ì˜ˆ: ë‚˜">
                </div>
                <div>
                    <label class="text-xs text-gray-400">íŒŒíŠ¸ë„ˆ ì´ë¦„</label>
                    <input type="text" id="p2" placeholder="ì˜ˆ: í™ê¸¸ë™">
                </div>
                <div class="flex gap-2 pt-2">
                    <button onclick="addMatch('ìŠ¹')" class="flex-1 bg-green-500 hover:bg-green-600 py-3 rounded-lg font-bold">ìŠ¹ë¦¬</button>
                    <button onclick="addMatch('íŒ¨')" class="flex-1 bg-red-500 hover:bg-red-600 py-3 rounded-lg font-bold">íŒ¨ë°°</button>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 class="text-lg font-bold mb-4 text-gray-300 border-b border-gray-600 pb-2">ğŸ† ì„ ìˆ˜ ë­í‚¹ (ìŠ¹ë¥ )</h2>
            <div id="rankingList" class="space-y-3">
                </div>
        </div>

        <div class="card">
            <h2 class="text-lg font-bold mb-4 text-gray-300 border-b border-gray-600 pb-2">ğŸ“‹ ê²½ê¸° íˆìŠ¤í† ë¦¬</h2>
            <div id="historyList" class="space-y-2 max-h-60 overflow-y-auto">
                </div>
        </div>

        <button onclick="clearData()" class="w-full text-gray-500 text-xs mt-4 underline">ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”</button>
    </div>

    <script>
        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        let matches = JSON.parse(localStorage.getItem('nijiMatches')) || [];

        function addMatch(result) {
            const p1 = document.getElementById('p1').value.trim();
            const p2 = document.getElementById('p2').value.trim();

            if (!p1 || !p2) {
                alert("ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            const match = { p1, p2, result, time: new Date().toLocaleDateString() };
            matches.unshift(match);
            localStorage.setItem('nijiMatches', JSON.stringify(matches));
            
            alert("ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!");
            render();
        }

        function render() {
            const rankingList = document.getElementById('rankingList');
            const historyList = document.getElementById('historyList');

            // 1. ê²½ê¸° ê¸°ë¡ í‘œì‹œ
            historyList.innerHTML = matches.map(m => `
                <div class="flex justify-between items-center text-sm p-2 bg-black/20 rounded">
                    <span>${m.time} | <b>${m.p1}</b> & <b>${m.p2}</b></span>
                    <span class="${m.result === 'ìŠ¹' ? 'text-green-400' : 'text-red-400'} font-bold">${m.result}</span>
                </div>
            `).join('') || '<p class="text-gray-500 text-center">ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';

            // 2. ë­í‚¹ ë° ìŠ¹ë¥  ê³„ì‚°
            const playerStats = {};
            matches.forEach(m => {
                [m.p1, m.p2].forEach(name => {
                    if (!playerStats[name]) playerStats[name] = { w: 0, l: 0 };
                    m.result === 'ìŠ¹' ? playerStats[name].w++ : playerStats[name].l++;
                });
            });

            const sortedPlayers = Object.keys(playerStats).map(name => {
                const { w, l } = playerStats[name];
                const winRate = ((w / (w + l)) * 100).toFixed(1);
                return { name, winRate, w, l };
            }).sort((a, b) => b.winRate - a.winRate);

            rankingList.innerHTML = sortedPlayers.map((p, i) => `
                <div class="flex justify-between items-center">
                    <span class="text-sm">${i+1}. <span class="text-green-400 font-bold">${p.name}</span></span>
                    <span class="text-xs text-gray-300">${p.winRate}% (${p.w}ìŠ¹ ${p.l}íŒ¨)</span>
                </div>
            `).join('') || '<p class="text-gray-500 text-center text-sm">ê¸°ë¡ì„ ë¨¼ì € ì¶”ê°€í•˜ì„¸ìš”.</p>';
        }

        function clearData() {
            if (confirm("ì •ë§ë¡œ ëª¨ë“  ê¸°ë¡ì„ ì§€ìš¸ê¹Œìš”?")) {
                localStorage.removeItem('nijiMatches');
                matches = [];
                render();
            }
        }

        // ì•± ì‹œì‘ì‹œ í™”ë©´ ê·¸ë¦¬ê¸°
        render();
    </script>
</body>
</html>
